<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Anki 数理化生公式图鉴全屏居中模版</title>
  <link rel="stylesheet" href="https://app.classeur.io/base-min.css" />
  <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>

<body>
  <div class="export-container"><h1 id="anki-数理化生公式图鉴全屏居中模版">Anki 数理化生公式图鉴全屏居中模版</h1>
<h2 id="简介">简介</h2>
<h3 id="先上图：">先上图：</h3>
<p>比如，你有一个不敢忘掉的公式：</p>
<blockquote>
<ol start="93">
<li>椭圆 \(\frac{x^2}{a^2}+\frac{x^2}{b^2}=1(a&gt;b&gt;0)\) 焦半径公式<br>
\(|PF_1|=a+ex,\,|PF_2|=a-ex\)</li>
</ol>
</blockquote>
<p>你要把它放进 Anki 里复习：</p>
<ul>
<li>正面：</li>
</ul>
<pre class=" language-latex"><code class="prism  language-latex">93. 椭圆 <span class="token equation string">$<span class="token equation-command regex">\frac</span>{x^2}{a^2}+<span class="token equation-command regex">\frac</span>{x^2}{b^2}=1(a&gt;b&gt;0)$</span> 焦半径公式 
<span class="token equation string">$|PF_1|=<span class="token equation-command regex">\color</span>{red}(<span class="token equation-command regex">\color</span>{transparent}{a+ex}<span class="token equation-command regex">\color</span>{red}),<span class="token equation-command regex">\,</span>|PF_2|=<span class="token equation-command regex">\color</span>{red}(<span class="token equation-command regex">\color</span>{transparent}{a-ex}<span class="token equation-command regex">\color</span>{red})$</span>
</code></pre>
<ul>
<li>背面：</li>
</ul>
<pre class=" language-latex"><code class="prism  language-latex">93. 椭圆 <span class="token equation string">$<span class="token equation-command regex">\frac</span>{x^2}{a^2}+<span class="token equation-command regex">\frac</span>{x^2}{b^2}=1(a&gt;b&gt;0)$</span> 焦半径公式 
<span class="token equation string">$|PF_1|=a+ex,<span class="token equation-command regex">\,</span>|PF_2|=a-ex$</span>
</code></pre>
<p>像这样：<br>
<img src="https://i.imgur.com/2KJtbTt.png" alt="编辑界面"></p>
<p>最后你得到了这个：</p>
<p><img src="https://i.imgur.com/fU2wXXm.png" alt="正面"></p>
<p>假设你有坚持复习，从此再也不怕把它忘掉了，完成！</p>
<h3 id="模板使用方法（跳至代码）">模板使用方法（<a href="#%E6%A8%A1%E7%89%88%E4%BB%A3%E7%A0%81">跳至代码</a>）</h3>
<ol>
<li>
<p>追求完美的你，可以用 TeX 书写数学公式，就像上述例图一样。<br>
推荐使用行内公式 <code>一些文字 ${公式}$ 一些文字</code>。<br>
更具体用法参见：<a href="http://mlworks.cn/posts/introduction-to-mathjax-and-latex-expression/">Mathjax与LaTex公式简介</a></p>
</li>
<li>
<p>简单粗暴的你，出可以简单地在一些百科上找点数学公式截图下来直接粘贴到卡片中。</p>
</li>
</ol>
<p>卡片中的内容将会被等比例放大以适应屏幕。</p>
<h3 id="原理">原理</h3>
<p>用 js 计算内容大小，作一些简单的几何变换得到居中后的坐标。具体实现方式请看代码：在<code>卡片样式</code>里搜索<code>等比放大适应屏幕</code></p>
<p>Anki 把 <code>卡片样式</code> 里的文本直接嵌到了一个<code>&lt;style&gt;{卡片样式}&lt;/style&gt;</code>标签里，利用这一点，我们可以用 <code>&lt;/style&gt;{你的HTML代码}&lt;style&gt;</code> 在卡片样式里添加 HTML 代码。</p>
<p>在<code>卡片样式</code>里通过 CDN 方式调用了 MathJax 和 jQuery 库，目前还不晓得怎样本地化，懂的请留言，不胜感激。</p>
<h2 id="模版代码">模版代码</h2>
<p>可直接复制一个 <code>基础</code> 模版后，向新模版粘贴代码。</p>
<p>像这样：<br>
<img src="https://i.imgur.com/eBvB9eu.png" alt="模板示例"></p>
<h3 id="正面模版：">正面模版：</h3>
<pre class=" language-html"><code class="prism  language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center-box<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>math<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{正面}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"><span class="token function">tryTypeset</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3 id="背面模版：">背面模版：</h3>
<pre class=" language-html"><code class="prism  language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center-box<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>math<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{背面}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"><span class="token function">tryTypeset</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3 id="样式：">样式：</h3>
<pre class=" language-html"><code class="prism  language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
<span class="token comment" spellcheck="true">/* 卡片样式 */</span>
<span class="token selector">body, html</span><span class="token punctuation">{</span>
	<span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector"><span class="token class">.card</span></span><span class="token punctuation">{</span>
	<span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">"FangSong"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/* Anki 图片大小修正 */</span>
<span class="token selector">img</span><span class="token punctuation">{</span><span class="token property">max-width</span><span class="token punctuation">:</span> initial<span class="token punctuation">;</span> <span class="token property">max-height</span><span class="token punctuation">:</span> initial<span class="token punctuation">;</span><span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/* 居中盒子 */</span>
<span class="token selector"><span class="token class">.center-box</span></span><span class="token punctuation">{</span>
	<span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">/* 居中盒子 begin DEBUG * /
html		{background: #888}
body		{background: #999}
.card		{background: #AAA}
.center-box	{background: #DDD}
.content	{background: #EEE}
/* 居中盒子 end */</span>

</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/x-mathjax-config<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
MathJax<span class="token punctuation">.</span>Hub<span class="token punctuation">.</span>processSectionDelay <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
MathJax<span class="token punctuation">.</span>Hub<span class="token punctuation">.</span><span class="token function">Config</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	messageStyle<span class="token punctuation">:</span><span class="token string">"none"</span><span class="token punctuation">,</span>
	showProcessingMessages<span class="token punctuation">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
	skipStartupTypeset<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
	tex2jax<span class="token punctuation">:</span> <span class="token punctuation">{</span>
		inlineMath<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'$'</span><span class="token punctuation">,</span><span class="token string">'$'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'\\('</span><span class="token punctuation">,</span><span class="token string">'\\)'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		processEscaping<span class="token punctuation">:</span> <span class="token boolean">true</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token string">"HTML-CSS"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
		minScaleAdjust<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
		undefinedFamily<span class="token punctuation">:</span> <span class="token string">'"FangSong"'</span><span class="token punctuation">,</span>
		EqnChunkDelay<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span>
	<span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config<span class="token punctuation">=</span>TeX-AMS_HTML-full<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://code.jquery.com/jquery-3.2.1.slim.min.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">var</span> centerZoom <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span> cbox <span class="token operator">=</span> <span class="token string">'.center-box'</span><span class="token punctuation">;</span>

	<span class="token comment" spellcheck="true">// 等里面的图片加载出来</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">$</span><span class="token punctuation">(</span>cbox<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

	<span class="token comment" spellcheck="true">// 初始化位置</span>
	<span class="token function">$</span><span class="token punctuation">(</span>cbox<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		position<span class="token punctuation">:</span> <span class="token string">'absolute'</span><span class="token punctuation">,</span>
		left<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
		top<span class="token punctuation">:</span>	<span class="token number">0</span><span class="token punctuation">,</span>
		zoom<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment" spellcheck="true">// 抵消卡片的 zoom 对坐标计算的影响</span>
	<span class="token comment" spellcheck="true">// 待填坑: 如果被 zoom 的不是 .card 而是 body 之类的就可能偏移</span>
	<span class="token keyword">var</span> cardzoom <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".card"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">"zoom"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> ww <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> cardzoom<span class="token punctuation">;</span>
	<span class="token keyword">var</span> wh <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> cardzoom<span class="token punctuation">;</span>
	<span class="token keyword">var</span> bw <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>cbox<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">outerWidth</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> bh <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>cbox<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">outerHeight</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment" spellcheck="true">// 等比放大适应屏幕</span>
	<span class="token keyword">var</span> zoom <span class="token operator">=</span> <span class="token punctuation">(</span>bw <span class="token operator">/</span> bh <span class="token operator">&gt;</span> ww <span class="token operator">/</span> wh<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span>ww <span class="token operator">/</span> bw<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>wh <span class="token operator">/</span> bh<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment" spellcheck="true">// 相对屏幕缩放倍数</span>
	zoom <span class="token operator">*</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token comment" spellcheck="true">// 最大放大 5 倍</span>
	zoom <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>zoom<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment" spellcheck="true">// 计算居中坐标</span>
	<span class="token keyword">var</span> st <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scrollTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> sl <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scrollLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> cx <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ww <span class="token operator">-</span> bw <span class="token operator">*</span> zoom<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> sl<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> cy <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>wh <span class="token operator">-</span> bh <span class="token operator">*</span> zoom<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> st<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment" spellcheck="true">// 设置位置和放大zoom</span>
	<span class="token function">$</span><span class="token punctuation">(</span>cbox<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		position<span class="token punctuation">:</span> <span class="token string">'absolute'</span><span class="token punctuation">,</span>
		left<span class="token punctuation">:</span> cx <span class="token operator">/</span> zoom<span class="token punctuation">,</span>
		top<span class="token punctuation">:</span>	cy <span class="token operator">/</span> zoom<span class="token punctuation">,</span>
		zoom<span class="token punctuation">:</span> zoom<span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment" spellcheck="true">// 成功返回 true</span>
	<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> centerTypeset <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>	<span class="token function">centerZoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token operator">&amp;&amp;</span> <span class="token string">"undefined"</span> <span class="token operator">!=</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>MathJax<span class="token punctuation">)</span>
		<span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token operator">!</span>MathJax<span class="token punctuation">.</span>Hub<span class="token punctuation">.</span><span class="token function">Typeset</span><span class="token punctuation">(</span><span class="token string">"math"</span><span class="token punctuation">,</span> centerZoom<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> tryTypeset <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">centerTypeset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">setTimeout</span><span class="token punctuation">(</span>tryTypeset<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">$</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>centerZoom<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div>
</body>

</html>
